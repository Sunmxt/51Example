C51 COMPILER V9.00   UTILS                                                                 03/24/2017 21:47:36 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE UTILS
OBJECT MODULE PLACED IN utils.OBJ
COMPILER INVOKED BY: E:\Program Files (x86)\Keil\C51\BIN\C51.EXE utils.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "utils.h"
   2          
   3          void CheckButton(ButtonContext *Context ,ReadButtonStatus Read, uchar CounterForward, uchar DownTime
   4                              , uchar LongDownTime)
   5          {
   6   1          bit status;
   7   1          
   8   1          status = Read();
   9   1          
  10   1          
  11   1          switch(Context -> status & BUTTON_DETECT_MASK)
  12   1          {
  13   2          case BUTTON_NONE:
  14   2              if(!status)
  15   2                  DETECT_STATUS_SET(*Context, BUTTON_DETECTED);
  16   2              else
  17   2                  goto Check_Button_Clear_Return;
  18   2              
  19   2              break;
  20   2          case BUTTON_DETECTED:
  21   2              if(status)
  22   2                  goto Check_Button_Clear_Return;
  23   2              
  24   2              if(Context -> counter >= DownTime)
  25   2                  DETECT_STATUS_SET(*Context, BUTTON_DOWN);
  26   2              break;
  27   2              
  28   2          case BUTTON_DOWN:
  29   2              if(Context -> counter >= LongDownTime)
  30   2              {
  31   3                  DETECT_STATUS_SET(*Context, BUTTON_LONG_PUSH);
  32   3                  SET_BUTTON_MESSAGE(*Context, BUTTON_LONG_DOWN);
  33   3              }
  34   2              
  35   2              if(status)
  36   2              {
  37   3                  DETECT_STATUS_SET(*Context, BUTTON_NONE);
  38   3                  SET_BUTTON_MESSAGE(*Context, BUTTON_CLICKED);
  39   3                  Context -> counter = 0;
  40   3                  return;
  41   3              }
  42   2              break;
  43   2          case BUTTON_LONG_PUSH:
  44   2              if(status)
  45   2                  goto Check_Button_Clear_Return;
  46   2              
  47   2              return;
  48   2          }
  49   1      
  50   1          Context -> counter += CounterForward;    
  51   1          return;
  52   1          
  53   1      Check_Button_Clear_Return:
  54   1          Context -> status = 0;
  55   1          Context -> counter = 0;
C51 COMPILER V9.00   UTILS                                                                 03/24/2017 21:47:36 PAGE 2   

  56   1          return;
  57   1      }
  58          
  59          bit PWMControl(PWMPinContext *Context, uchar CounterForward)
  60          {
  61   1          Context -> counter += CounterForward;
  62   1          
  63   1          if( !(~Context -> high_width) ) return 1;
  64   1          return Context -> counter < Context -> high_width;
  65   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    223    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
